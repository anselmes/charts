{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Gateway Chart Values Schema",
  "description": "Schema for the Gateway API Helm chart values",
  "properties": {
    "routes": {
      "type": "array",
      "description": "Define routes for the Gateway API",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the route",
            "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
          },
          "kind": {
            "type": "string",
            "description": "Type of route",
            "enum": ["HTTPRoute", "HTTPSRoute", "TLSRoute", "TCPRoute", "UDPRoute", "GRPCRoute"]
          },
          "hostnames": {
            "type": "array",
            "description": "Hostnames for the route",
            "items": {
              "type": "string",
              "description": "Hostname pattern",
              "pattern": "^(\\*\\.)?([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?[.])*[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$"
            }
          },
          "parentRefs": {
            "type": "array",
            "description": "References to parent Gateways",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Name of the parent Gateway"
                },
                "namespace": {
                  "type": "string",
                  "description": "Namespace of the parent Gateway",
                  "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                },
                "sectionName": {
                  "type": "string",
                  "description": "Section name within the Gateway"
                },
                "port": {
                  "type": "integer",
                  "description": "Port number",
                  "minimum": 1,
                  "maximum": 65535
                }
              },
              "required": ["name"],
              "additionalProperties": false
            }
          },
          "gateways": {
            "type": "array",
            "description": "Legacy gateway references (deprecated in favor of parentRefs)",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Name of the Gateway"
                },
                "namespace": {
                  "type": "string",
                  "description": "Namespace of the Gateway",
                  "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                }
              },
              "required": ["name"],
              "additionalProperties": false
            }
          },
          "rules": {
            "type": "array",
            "description": "Routing rules",
            "items": {
              "type": "object",
              "properties": {
                "matches": {
                  "type": "array",
                  "description": "Route matching criteria",
                  "items": {
                    "type": "object",
                    "properties": {
                      "path": {
                        "type": "object",
                        "description": "Path matching criteria",
                        "properties": {
                          "type": {
                            "type": "string",
                            "enum": ["Exact", "PathPrefix", "RegularExpression"]
                          },
                          "value": {
                            "type": "string",
                            "description": "Path value to match"
                          }
                        },
                        "additionalProperties": false
                      },
                      "headers": {
                        "type": "array",
                        "description": "Header matching criteria",
                        "items": {
                          "type": "object",
                          "properties": {
                            "type": {
                              "type": "string",
                              "enum": ["Exact", "RegularExpression"]
                            },
                            "name": {
                              "type": "string",
                              "description": "Header name"
                            },
                            "value": {
                              "type": "string",
                              "description": "Header value"
                            }
                          },
                          "required": ["name", "value"],
                          "additionalProperties": false
                        }
                      },
                      "queryParams": {
                        "type": "array",
                        "description": "Query parameter matching criteria",
                        "items": {
                          "type": "object",
                          "properties": {
                            "type": {
                              "type": "string",
                              "enum": ["Exact", "RegularExpression"]
                            },
                            "name": {
                              "type": "string",
                              "description": "Query parameter name"
                            },
                            "value": {
                              "type": "string",
                              "description": "Query parameter value"
                            }
                          },
                          "required": ["name", "value"],
                          "additionalProperties": false
                        }
                      },
                      "method": {
                        "type": "string",
                        "description": "HTTP method to match",
                        "enum": ["GET", "HEAD", "POST", "PUT", "PATCH", "DELETE", "CONNECT", "OPTIONS", "TRACE"]
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "filters": {
                  "type": "array",
                  "description": "Route filters to apply",
                  "items": {
                    "type": "object",
                    "properties": {
                      "type": {
                        "type": "string",
                        "enum": ["RequestHeaderModifier", "ResponseHeaderModifier", "RequestMirror", "RequestRedirect", "URLRewrite", "ExtensionRef"]
                      },
                      "requestHeaderModifier": {
                        "type": "object",
                        "description": "Request header modification",
                        "properties": {
                          "set": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {"type": "string"},
                                "value": {"type": "string"}
                              },
                              "required": ["name", "value"]
                            }
                          },
                          "add": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {"type": "string"},
                                "value": {"type": "string"}
                              },
                              "required": ["name", "value"]
                            }
                          },
                          "remove": {
                            "type": "array",
                            "items": {"type": "string"}
                          }
                        },
                        "additionalProperties": false
                      },
                      "responseHeaderModifier": {
                        "type": "object",
                        "description": "Response header modification",
                        "properties": {
                          "set": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {"type": "string"},
                                "value": {"type": "string"}
                              },
                              "required": ["name", "value"]
                            }
                          },
                          "add": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {"type": "string"},
                                "value": {"type": "string"}
                              },
                              "required": ["name", "value"]
                            }
                          },
                          "remove": {
                            "type": "array",
                            "items": {"type": "string"}
                          }
                        },
                        "additionalProperties": false
                      },
                      "requestRedirect": {
                        "type": "object",
                        "description": "Request redirect configuration",
                        "properties": {
                          "scheme": {
                            "type": "string",
                            "enum": ["http", "https"]
                          },
                          "hostname": {
                            "type": "string",
                            "description": "Redirect hostname"
                          },
                          "path": {
                            "type": "object",
                            "properties": {
                              "type": {
                                "type": "string",
                                "enum": ["ReplaceFullPath", "ReplacePrefixMatch"]
                              },
                              "replaceFullPath": {"type": "string"},
                              "replacePrefixMatch": {"type": "string"}
                            }
                          },
                          "port": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 65535
                          },
                          "statusCode": {
                            "type": "integer",
                            "enum": [301, 302]
                          }
                        },
                        "additionalProperties": false
                      },
                      "urlRewrite": {
                        "type": "object",
                        "description": "URL rewrite configuration",
                        "properties": {
                          "hostname": {
                            "type": "string",
                            "description": "Rewrite hostname"
                          },
                          "path": {
                            "type": "object",
                            "properties": {
                              "type": {
                                "type": "string",
                                "enum": ["ReplaceFullPath", "ReplacePrefixMatch"]
                              },
                              "replaceFullPath": {"type": "string"},
                              "replacePrefixMatch": {"type": "string"}
                            }
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "required": ["type"],
                    "additionalProperties": false
                  }
                },
                "backendRefs": {
                  "type": "array",
                  "description": "Backend service references",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "Name of the backend service"
                      },
                      "namespace": {
                        "type": "string",
                        "description": "Namespace of the backend service",
                        "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                      },
                      "kind": {
                        "type": "string",
                        "description": "Kind of backend resource",
                        "default": "Service"
                      },
                      "port": {
                        "type": "integer",
                        "description": "Backend service port",
                        "minimum": 1,
                        "maximum": 65535
                      },
                      "weight": {
                        "type": "integer",
                        "description": "Weight for load balancing",
                        "minimum": 0,
                        "maximum": 1000000,
                        "default": 1
                      },
                      "filters": {
                        "type": "array",
                        "description": "Filters to apply to this backend",
                        "items": {
                          "type": "object",
                          "additionalProperties": true
                        }
                      }
                    },
                    "required": ["name"],
                    "additionalProperties": false
                  },
                  "minItems": 1
                },
                "timeouts": {
                  "type": "object",
                  "description": "Timeout configuration for the route",
                  "properties": {
                    "request": {
                      "type": "string",
                      "description": "Request timeout duration",
                      "pattern": "^[0-9]+[smh]$"
                    },
                    "backendRequest": {
                      "type": "string",
                      "description": "Backend request timeout duration",
                      "pattern": "^[0-9]+[smh]$"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            },
            "minItems": 1
          }
        },
        "required": ["name", "kind", "rules"],
        "additionalProperties": false
      }
    },
    "policies": {
      "type": "array",
      "description": "Define policies for the Gateway API",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the policy",
            "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
          },
          "validation": {
            "type": "object",
            "description": "Validation policy configuration",
            "properties": {
              "hostname": {
                "type": "string",
                "description": "Hostname to validate",
                "pattern": "^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?[.])*[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$"
              },
              "wellKnownCACertificates": {
                "type": "string",
                "description": "Well-known CA certificates to use",
                "enum": ["System"]
              },
              "subjectAltNames": {
                "type": "array",
                "description": "Subject Alternative Names to validate",
                "items": {
                  "type": "object",
                  "properties": {
                    "type": {
                      "type": "string",
                      "enum": ["Hostname", "URI"]
                    },
                    "hostname": {
                      "type": "string"
                    },
                    "uri": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "caCertificateRefs": {
                "type": "array",
                "description": "CA certificate references",
                "items": {
                  "type": "object",
                  "properties": {
                    "group": {
                      "type": "string",
                      "description": "API group"
                    },
                    "kind": {
                      "type": "string",
                      "description": "Resource kind"
                    },
                    "name": {
                      "type": "string",
                      "description": "Resource name"
                    },
                    "namespace": {
                      "type": "string",
                      "description": "Resource namespace",
                      "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                    }
                  },
                  "required": ["kind", "name"],
                  "additionalProperties": false
                }
              }
            },
            "additionalProperties": false
          },
          "targetRefs": {
            "type": "array",
            "description": "Target references for the policy",
            "items": {
              "type": "object",
              "properties": {
                "group": {
                  "type": "string",
                  "description": "API group"
                },
                "kind": {
                  "type": "string",
                  "description": "Resource kind"
                },
                "name": {
                  "type": "string",
                  "description": "Resource name"
                },
                "namespace": {
                  "type": "string",
                  "description": "Resource namespace",
                  "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                }
              },
              "required": ["kind", "name"],
              "additionalProperties": false
            }
          }
        },
        "required": ["name"],
        "additionalProperties": false
      }
    },
    "grants": {
      "type": "array",
      "description": "Define resource grants for the Gateway API",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the grant",
            "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
          },
          "to": {
            "type": "array",
            "description": "Resources that can be referenced",
            "items": {
              "type": "object",
              "properties": {
                "group": {
                  "type": "string",
                  "description": "API group"
                },
                "kind": {
                  "type": "string",
                  "description": "Resource kind"
                },
                "name": {
                  "type": "string",
                  "description": "Resource name"
                },
                "namespace": {
                  "type": "string",
                  "description": "Resource namespace",
                  "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                }
              },
              "required": ["kind"],
              "additionalProperties": false
            },
            "minItems": 1
          },
          "from": {
            "type": "array",
            "description": "Resources that can make references",
            "items": {
              "type": "object",
              "properties": {
                "group": {
                  "type": "string",
                  "description": "API group"
                },
                "kind": {
                  "type": "string",
                  "description": "Resource kind"
                },
                "namespace": {
                  "type": "string",
                  "description": "Resource namespace",
                  "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                }
              },
              "required": ["group", "kind"],
              "additionalProperties": false
            },
            "minItems": 1
          }
        },
        "required": ["name", "to", "from"],
        "additionalProperties": false
      }
    },
    "gateways": {
      "type": "array",
      "description": "Define Gateway configurations",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the Gateway",
            "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
          },
          "className": {
            "type": "string",
            "description": "Gateway class name"
          },
          "annotations": {
            "type": "object",
            "description": "Gateway annotations",
            "additionalProperties": {
              "type": "string"
            }
          },
          "labels": {
            "type": "object",
            "description": "Gateway labels",
            "additionalProperties": {
              "type": "string"
            }
          },
          "infrastructure": {
            "type": "object",
            "description": "Infrastructure-specific configuration",
            "properties": {
              "annotations": {
                "type": "object",
                "description": "Infrastructure annotations",
                "additionalProperties": {
                  "type": "string"
                }
              },
              "labels": {
                "type": "object",
                "description": "Infrastructure labels",
                "additionalProperties": {
                  "type": "string"
                }
              }
            },
            "additionalProperties": false
          },
          "addresses": {
            "type": "array",
            "description": "Gateway addresses",
            "items": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "enum": ["IPAddress", "Hostname", "NamedAddress"]
                },
                "value": {
                  "type": "string",
                  "description": "Address value"
                }
              },
              "required": ["value"],
              "additionalProperties": false
            }
          },
          "listeners": {
            "type": "array",
            "description": "Gateway listeners",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Name of the listener",
                  "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                },
                "hostname": {
                  "type": "string",
                  "description": "Hostname for the listener",
                  "pattern": "^(\\*\\.)?([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?[.])*[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$"
                },
                "port": {
                  "type": "integer",
                  "description": "Port number",
                  "minimum": 1,
                  "maximum": 65535
                },
                "protocol": {
                  "type": "string",
                  "description": "Protocol for the listener",
                  "enum": ["HTTP", "HTTPS", "TLS", "TCP", "UDP"]
                },
                "tls": {
                  "type": "object",
                  "description": "TLS configuration",
                  "properties": {
                    "mode": {
                      "type": "string",
                      "description": "TLS mode",
                      "enum": ["Terminate", "Passthrough"]
                    },
                    "frontendValidation": {
                      "type": "object",
                      "description": "Frontend certificate validation",
                      "properties": {
                        "caCertificateRefs": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "group": {"type": "string"},
                              "kind": {"type": "string", "default": "Secret"},
                              "name": {"type": "string"},
                              "namespace": {"type": "string"}
                            },
                            "required": ["name"]
                          }
                        }
                      },
                      "additionalProperties": false
                    },
                    "certificateRefs": {
                      "type": "array",
                      "description": "Certificate references",
                      "items": {
                        "type": "object",
                        "properties": {
                          "group": {
                            "type": "string",
                            "description": "API group"
                          },
                          "kind": {
                            "type": "string",
                            "description": "Resource kind",
                            "default": "Secret"
                          },
                          "name": {
                            "type": "string",
                            "description": "Certificate name"
                          },
                          "namespace": {
                            "type": "string",
                            "description": "Certificate namespace",
                            "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
                          },
                          "issuer": {
                            "type": "string",
                            "description": "Certificate issuer (custom field)"
                          }
                        },
                        "required": ["name"],
                        "additionalProperties": false
                      }
                    },
                    "options": {
                      "type": "object",
                      "description": "TLS options",
                      "additionalProperties": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "allowedRoutes": {
                  "type": "object",
                  "description": "Routes allowed to attach to this listener",
                  "properties": {
                    "namespaces": {
                      "type": "object",
                      "description": "Namespace selector",
                      "properties": {
                        "from": {
                          "type": "string",
                          "description": "Namespace selection strategy",
                          "enum": ["All", "Selector", "Same"]
                        },
                        "selector": {
                          "type": "object",
                          "description": "Label selector for namespaces",
                          "properties": {
                            "matchLabels": {
                              "type": "object",
                              "additionalProperties": {
                                "type": "string"
                              }
                            },
                            "matchExpressions": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "key": {
                                    "type": "string"
                                  },
                                  "operator": {
                                    "type": "string",
                                    "enum": ["In", "NotIn", "Exists", "DoesNotExist"]
                                  },
                                  "values": {
                                    "type": "array",
                                    "items": {
                                      "type": "string"
                                    }
                                  }
                                },
                                "required": ["key", "operator"]
                              }
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "additionalProperties": false
                    },
                    "kinds": {
                      "type": "array",
                      "description": "Route kinds allowed",
                      "items": {
                        "type": "object",
                        "properties": {
                          "group": {
                            "type": "string",
                            "description": "API group"
                          },
                          "kind": {
                            "type": "string",
                            "description": "Route kind"
                          }
                        },
                        "required": ["kind"],
                        "additionalProperties": false
                      }
                    }
                  },
                  "additionalProperties": false
                }
              },
              "required": ["name", "port", "protocol"],
              "additionalProperties": false
            },
            "minItems": 1
          }
        },
        "required": ["name", "className", "listeners"],
        "additionalProperties": false
      }
    },
    "global": {
      "type": "object",
      "description": "Global configuration that applies to all components",
      "properties": {
        "imageRegistry": {
          "type": "string",
          "description": "Global Docker image registry"
        },
        "imagePullSecrets": {
          "type": "array",
          "description": "Global image pull secrets",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the image pull secret"
              }
            },
            "required": ["name"],
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": true
    },
    "metadata": {
      "type": "object",
      "description": "Chart metadata and configuration",
      "properties": {
        "namespace": {
          "type": "string",
          "description": "Default namespace for Gateway API resources",
          "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
        },
        "labels": {
          "type": "object",
          "description": "Common labels applied to all resources",
          "additionalProperties": {
            "type": "string"
          }
        },
        "annotations": {
          "type": "object",
          "description": "Common annotations applied to all resources",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
