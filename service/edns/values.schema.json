{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "EDNS Chart Values Schema",
  "description": "Schema for the EDNS (External DNS) Helm chart values",
  "properties": {
    "endpoints": {
      "anyOf": [
        {
          "type": "null"
        },
        {
          "type": "array",
          "description": "Define DNS endpoints to be managed by ExternalDNS",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the DNS endpoint",
                "pattern": "^[a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?$"
              },
              "records": {
                "type": "array",
                "description": "List of DNS records for this endpoint",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "description": "DNS record name (domain name)",
                      "pattern": "^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?[.])*[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$"
                    },
                    "type": {
                      "type": "string",
                      "description": "Type of DNS record",
                      "enum": ["A", "AAAA", "CNAME", "MX", "TXT", "NS", "PTR", "SRV", "CAA"],
                      "default": "A"
                    },
                    "ttl": {
                      "type": "integer",
                      "description": "Time-to-live for the DNS record in seconds",
                      "minimum": 1,
                      "maximum": 2147483647,
                      "default": 300
                    },
                    "targets": {
                      "type": "array",
                      "description": "Target values for the DNS record",
                      "items": {
                        "type": "string",
                        "description": "Target value (IP address, hostname, or text)"
                      },
                      "minItems": 1
                    }
                  },
                  "required": ["name", "targets"],
                  "additionalProperties": false
                },
                "minItems": 1
              }
            },
            "required": ["name", "records"],
            "additionalProperties": false
          }
        }
      ]
    },
    "externaldns": {
      "type": "object",
      "description": "ExternalDNS configuration for managing DNS records dynamically",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable or disable ExternalDNS deployment",
          "default": false
        },
        "policy": {
          "type": "string",
          "description": "Policy for managing DNS records",
          "enum": ["sync", "upsert-only", "create-only"],
          "default": "sync"
        },
        "sources": {
          "type": "array",
          "description": "Sources of DNS records for ExternalDNS",
          "items": {
            "type": "string",
            "enum": [
              "crd",
              "gateway-grpcroute",
              "gateway-httproute",
              "gateway-tcproute",
              "gateway-tlsroute",
              "gateway-udproute",
              "service",
              "ingress",
              "istio-gateway",
              "istio-virtualservice",
              "ambassador-host",
              "contour-httpproxy",
              "node"
            ]
          },
          "uniqueItems": true
        },
        "provider": {
          "type": "object",
          "description": "DNS provider configuration",
          "properties": {
            "name": {
              "type": "string",
              "description": "Name of the DNS provider",
              "enum": [
                "webhook",
                "aws",
                "azure",
                "azure-dns",
                "cloudflare",
                "google",
                "infoblox",
                "rfc2136",
                "digitalocean",
                "linode",
                "ovh",
                "dnsimple",
                "akamai",
                "ns1",
                "transip",
                "godaddy",
                "vultr",
                "pdns",
                "coredns",
                "skydns"
              ]
            },
            "env": {
              "type": "array",
              "description": "Environment variables for the DNS provider",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Environment variable name"
                  },
                  "value": {
                    "type": "string",
                    "description": "Environment variable value"
                  },
                  "valueFrom": {
                    "type": "object",
                    "description": "Source for environment variable value",
                    "properties": {
                      "secretKeyRef": {
                        "type": "object",
                        "description": "Reference to a secret key",
                        "properties": {
                          "name": {
                            "type": "string",
                            "description": "Name of the secret"
                          },
                          "key": {
                            "type": "string",
                            "description": "Key within the secret"
                          },
                          "optional": {
                            "type": "boolean",
                            "description": "Whether the secret key is optional"
                          }
                        },
                        "required": ["name", "key"],
                        "additionalProperties": false
                      },
                      "configMapKeyRef": {
                        "type": "object",
                        "description": "Reference to a config map key",
                        "properties": {
                          "name": {
                            "type": "string",
                            "description": "Name of the config map"
                          },
                          "key": {
                            "type": "string",
                            "description": "Key within the config map"
                          },
                          "optional": {
                            "type": "boolean",
                            "description": "Whether the config map key is optional"
                          }
                        },
                        "required": ["name", "key"],
                        "additionalProperties": false
                      },
                      "fieldRef": {
                        "type": "object",
                        "description": "Reference to a field",
                        "properties": {
                          "fieldPath": {
                            "type": "string",
                            "description": "Path to the field"
                          }
                        },
                        "required": ["fieldPath"],
                        "additionalProperties": false
                      }
                    },
                    "oneOf": [
                      {"required": ["secretKeyRef"]},
                      {"required": ["configMapKeyRef"]},
                      {"required": ["fieldRef"]}
                    ],
                    "additionalProperties": false
                  }
                },
                "required": ["name"],
                "oneOf": [
                  {"required": ["value"]},
                  {"required": ["valueFrom"]}
                ],
                "additionalProperties": false
              }
            },
            "webhook": {
              "type": "object",
              "description": "Webhook provider configuration",
              "properties": {
                "image": {
                  "type": "object",
                  "description": "Webhook image configuration",
                  "properties": {
                    "repository": {
                      "anyOf": [
                        {"type": "null"},
                        {"type": "string"}
                      ],
                      "description": "Webhook image repository"
                    },
                    "tag": {
                      "anyOf": [
                        {"type": "null"},
                        {"type": "string"}
                      ],
                      "description": "Webhook image tag"
                    }
                  },
                  "additionalProperties": true
                },
                "extraVolumeMounts": {
                  "type": "array",
                  "description": "Extra volume mounts for webhook",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "Volume mount name"
                      },
                      "mountPath": {
                        "type": "string",
                        "description": "Mount path in container"
                      },
                      "readOnly": {
                        "type": "boolean",
                        "description": "Whether mount is read-only"
                      },
                      "subPath": {
                        "type": "string",
                        "description": "Sub-path within the volume"
                      }
                    },
                    "required": ["name", "mountPath"],
                    "additionalProperties": false
                  }
                }
              },
              "additionalProperties": true
            }
          },
          "additionalProperties": true
        },
        "extraArgs": {
          "anyOf": [
            {
              "type": "array",
              "description": "Additional arguments for ExternalDNS",
              "items": {
                "type": "string"
              }
            },
            {
              "type": "object",
              "description": "Additional arguments as object (for backward compatibility)",
              "additionalProperties": true
            }
          ]
        },
        "extraVolumes": {
          "type": "array",
          "description": "Extra volumes for ExternalDNS",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Volume name"
              },
              "secret": {
                "type": "object",
                "description": "Secret volume source",
                "properties": {
                  "secretName": {
                    "type": "string",
                    "description": "Name of the secret"
                  },
                  "optional": {
                    "type": "boolean",
                    "description": "Whether the secret is optional"
                  },
                  "defaultMode": {
                    "type": "integer",
                    "description": "Default file mode for secret files",
                    "minimum": 0,
                    "maximum": 511
                  }
                },
                "required": ["secretName"],
                "additionalProperties": true
              },
              "configMap": {
                "type": "object",
                "description": "ConfigMap volume source",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Name of the config map"
                  },
                  "optional": {
                    "type": "boolean",
                    "description": "Whether the config map is optional"
                  },
                  "defaultMode": {
                    "type": "integer",
                    "description": "Default file mode for config map files",
                    "minimum": 0,
                    "maximum": 511
                  }
                },
                "required": ["name"],
                "additionalProperties": true
              },
              "emptyDir": {
                "type": "object",
                "description": "EmptyDir volume source",
                "properties": {
                  "sizeLimit": {
                    "type": "string",
                    "description": "Size limit for empty dir volume"
                  }
                },
                "additionalProperties": true
              },
              "hostPath": {
                "type": "object",
                "description": "HostPath volume source",
                "properties": {
                  "path": {
                    "type": "string",
                    "description": "Path on the host"
                  },
                  "type": {
                    "type": "string",
                    "description": "Type of host path",
                    "enum": ["", "DirectoryOrCreate", "Directory", "FileOrCreate", "File", "Socket", "CharDevice", "BlockDevice"]
                  }
                },
                "required": ["path"],
                "additionalProperties": true
              }
            },
            "required": ["name"],
            "additionalProperties": true
          }
        },
        "domainFilters": {
          "type": "array",
          "description": "Domain filters to limit which domains ExternalDNS manages",
          "items": {
            "type": "string",
            "pattern": "^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?[.])*[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$"
          }
        },
        "interval": {
          "type": "string",
          "description": "Interval between synchronizations",
          "pattern": "^[0-9]+(ns|us|Âµs|ms|s|m|h)$",
          "default": "1m"
        },
        "logLevel": {
          "type": "string",
          "description": "Log level for ExternalDNS",
          "enum": ["panic", "fatal", "error", "warn", "info", "debug", "trace"],
          "default": "info"
        },
        "logFormat": {
          "type": "string",
          "description": "Log format for ExternalDNS",
          "enum": ["text", "json"],
          "default": "text"
        },
        "txtOwnerId": {
          "type": "string",
          "description": "TXT record owner ID for ownership verification"
        },
        "txtPrefix": {
          "type": "string",
          "description": "Prefix for TXT records",
          "default": "external-dns-"
        }
      },
      "additionalProperties": true
    },
    "global": {
      "type": "object",
      "description": "Global configuration that applies to all components",
      "properties": {
        "imageRegistry": {
          "type": "string",
          "description": "Global Docker image registry"
        },
        "imagePullSecrets": {
          "type": "array",
          "description": "Global image pull secrets",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the image pull secret"
              }
            },
            "required": ["name"],
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
