---

# MARK: Postgres

postgres:
  enabled: false

  image:
    registry: ghcr.io
    repository: zalando/postgres-operator
    tag: v1.15.1
    pullPolicy: "IfNotPresent"

  # general configuration parameters
  configGeneral:
    # Spilo docker image
    docker_image: ghcr.io/zalando/spilo-17:4.0-p3

  configKubernetes:
    # use finalizers to ensure all managed resources are deleted prior to the postgresql CR
    # this avoids stale resources in case the operator misses a delete event or is not running
    # during deletion
    enable_finalizers: false
    # toggles if child resources should have an owner reference to the postgresql CR
    enable_owner_references: false
    # toggles pod anti affinity on the Postgres pods
    enable_pod_antiaffinity: false
    # toogles readiness probe for database pods
    enable_readiness_probe: false

  # configure interaction with non-Kubernetes objects from AWS or GCP
  configAwsOrGcp:
    # AWS region used to store EBS volumes
    aws_region: eu-central-1

    # enable automatic migration on AWS from gp2 to gp3 volumes
    enable_ebs_gp3_migration: false

  resources:
    limits:
      cpu: 500m
      memory: 500Mi
    requests:
      cpu: 100m
      memory: 250Mi

  securityContext:
    runAsUser: 1000
    runAsNonRoot: true
    readOnlyRootFilesystem: true
    allowPrivilegeEscalation: false

  extraEnvs:
    []
    # Exemple of settings maximum amount of memory / cpu that can be used by go process (to match resources.limits)
    # - name: MY_VAR
    #   value: my-value
    # - name: GOMAXPROCS
    #   valueFrom:
    #     resourceFieldRef:
    #       resource: limits.cpu
    # - name: GOMEMLIMIT
    #   valueFrom:
    #     resourceFieldRef:
    #       resource: limits.memory

  # Affinity for pod assignment
  # Ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity
  affinity: {}

  # Node labels for pod assignment
  # Ref: https://kubernetes.io/docs/user-guide/node-selection/
  nodeSelector: {}

  # Tolerations for pod assignment
  # Ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/
  tolerations: []

# MARK: Redis

redis:
  enabled: false

  redisOperator:
    name: redis-operator
    imageName: quay.io/opstree/redis-operator
    # Overrides the image tag whose default is the chart appVersion.
    imageTag: ""
    # -- initContainerImageTag is the init-config init container image tag.
    # If not specified, defaults to imageTag, then falls back to chart appVersion.
    # Typically only needs to be set when using a different version for the init container.
    initContainerImageTag: "v0.23.0"
    imagePullPolicy: Always
    imagePullSecrets: []

    # metrics configuration for monitoring
    metrics:
      # Enable metrics server
      enabled: true
      # The address the metrics endpoint binds to
      bindAddress: ":8080"

  resources:
    limits:
      cpu: 500m
      memory: 500Mi
    requests:
      cpu: 500m
      memory: 500Mi

  issuer:
    # Whether to create the issuer or not. You might want to disable this if instead you
    # want to use a ClusterIssuer that you simply want to provide.
    create: true
    # You can choose Issuer or ClusterIssuer here. The first one is namespaced, the second one
    # is available for global usage.
    kind: Issuer
    type: selfSigned
    name: redis-operator-issuer
    email: shubham.gupta@opstree.com
    server: https://acme-v02.api.letsencrypt.org/directory
    privateKeySecretName: letsencrypt-prod
    solver:
      enabled: true
      ingressClass: nginx

  certmanager:
    # Whether to use cert-manager for certificate management
    # Only effective when webhook=true
    # If webhook=true and certmanager.enabled=false, you need to manually create certificate secret
    enabled: false
    # API version of the cert-manager CRDs
    apiVersion: "cert-manager.io/v1"

  nodeSelector: {}
  tolerateAllTaints: false
  tolerations: []
  affinity: {}
