{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Operator Chart Values",
  "description": "Schema for operator chart values that deploys various Operators and their dependencies",
  "type": "object",
  "properties": {
    "postgres": {
      "type": "object",
      "description": "PostgreSQL operator configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable PostgreSQL operator deployment"
        },
        "image": {
          "type": "object",
          "description": "PostgreSQL operator image configuration",
          "properties": {
            "registry": {
              "type": "string",
              "description": "Container registry hostname"
            },
            "repository": {
              "type": "string",
              "description": "Container image repository"
            },
            "tag": {
              "type": "string",
              "description": "Container image tag"
            },
            "pullPolicy": {
              "type": "string",
              "enum": ["Always", "IfNotPresent", "Never"],
              "description": "Image pull policy"
            }
          },
          "additionalProperties": false
        },
        "configGeneral": {
          "type": "object",
          "description": "General configuration parameters",
          "properties": {
            "docker_image": {
              "type": "string",
              "description": "Spilo docker image"
            }
          },
          "additionalProperties": false
        },
        "configKubernetes": {
          "type": "object",
          "description": "Kubernetes-specific configuration",
          "properties": {
            "enable_finalizers": {
              "type": "boolean",
              "description": "Use finalizers to ensure all managed resources are deleted prior to the postgresql CR"
            },
            "enable_owner_references": {
              "type": "boolean",
              "description": "Whether child resources should have an owner reference to the postgresql CR"
            },
            "enable_pod_antiaffinity": {
              "type": "boolean",
              "description": "Enable pod anti affinity on the Postgres pods"
            },
            "enable_readiness_probe": {
              "type": "boolean",
              "description": "Enable readiness probe for database pods"
            }
          },
          "additionalProperties": false
        },
        "configAwsOrGcp": {
          "type": "object",
          "description": "AWS or GCP specific configuration",
          "properties": {
            "aws_region": {
              "type": "string",
              "description": "AWS region used to store EBS volumes"
            },
            "enable_ebs_gp3_migration": {
              "type": "boolean",
              "description": "Enable automatic migration on AWS from gp2 to gp3 volumes"
            }
          },
          "additionalProperties": false
        },
        "resources": {
          "type": "object",
          "description": "Resource limits and requests",
          "properties": {
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "pattern": "^[0-9]+m?$|^[0-9]*\\.?[0-9]+$"
                },
                "memory": {
                  "type": "string",
                  "pattern": "^[0-9]+[KMGTPE]?i?$"
                }
              },
              "additionalProperties": false
            },
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "pattern": "^[0-9]+m?$|^[0-9]*\\.?[0-9]+$"
                },
                "memory": {
                  "type": "string",
                  "pattern": "^[0-9]+[KMGTPE]?i?$"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "securityContext": {
          "type": "object",
          "description": "Security context configuration",
          "properties": {
            "runAsUser": {
              "type": "integer",
              "minimum": 0
            },
            "runAsNonRoot": {
              "type": "boolean"
            },
            "readOnlyRootFilesystem": {
              "type": "boolean"
            },
            "allowPrivilegeEscalation": {
              "type": "boolean"
            }
          },
          "additionalProperties": false
        },
        "extraEnvs": {
          "type": "array",
          "description": "Extra environment variables",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string"
              },
              "value": {
                "type": "string"
              },
              "valueFrom": {
                "type": "object"
              }
            },
            "required": ["name"],
            "additionalProperties": false
          }
        },
        "affinity": {
          "type": "object",
          "description": "Affinity for pod assignment"
        },
        "nodeSelector": {
          "type": "object",
          "description": "Node labels for pod assignment"
        },
        "tolerations": {
          "type": "array",
          "description": "Tolerations for pod assignment",
          "items": {
            "type": "object"
          }
        }
      },
      "additionalProperties": false
    },
    "redis": {
      "type": "object",
      "description": "Redis operator configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable Redis operator deployment"
        },
        "redisOperator": {
          "type": "object",
          "description": "Redis operator specific configuration",
          "properties": {
            "name": {
              "type": "string",
              "description": "Redis operator name"
            },
            "imageName": {
              "type": "string",
              "description": "Redis operator image name"
            },
            "imageTag": {
              "type": "string",
              "description": "Redis operator image tag"
            },
            "initContainerImageTag": {
              "type": "string",
              "description": "Init container image tag"
            },
            "imagePullPolicy": {
              "type": "string",
              "enum": ["Always", "IfNotPresent", "Never"],
              "description": "Image pull policy"
            },
            "imagePullSecrets": {
              "type": "array",
              "description": "Image pull secrets",
              "items": {
                "type": "object"
              }
            },
            "metrics": {
              "type": "object",
              "description": "Metrics configuration for monitoring",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "description": "Enable metrics server"
                },
                "bindAddress": {
                  "type": "string",
                  "description": "The address the metrics endpoint binds to"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "resources": {
          "type": "object",
          "description": "Resource limits and requests",
          "properties": {
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "pattern": "^[0-9]+m?$|^[0-9]*\\.?[0-9]+$"
                },
                "memory": {
                  "type": "string",
                  "pattern": "^[0-9]+[KMGTPE]?i?$"
                }
              },
              "additionalProperties": false
            },
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "pattern": "^[0-9]+m?$|^[0-9]*\\.?[0-9]+$"
                },
                "memory": {
                  "type": "string",
                  "pattern": "^[0-9]+[KMGTPE]?i?$"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "issuer": {
          "type": "object",
          "description": "Certificate issuer configuration",
          "properties": {
            "create": {
              "type": "boolean",
              "description": "Whether to create the issuer or not"
            },
            "kind": {
              "type": "string",
              "enum": ["Issuer", "ClusterIssuer"],
              "description": "Type of issuer (namespaced or global)"
            },
            "type": {
              "type": "string",
              "description": "Issuer type"
            },
            "name": {
              "type": "string",
              "description": "Issuer name"
            },
            "email": {
              "type": "string",
              "format": "email",
              "description": "Email for certificate registration"
            },
            "server": {
              "type": "string",
              "format": "uri",
              "description": "ACME server URL"
            },
            "privateKeySecretName": {
              "type": "string",
              "description": "Private key secret name"
            },
            "solver": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean"
                },
                "ingressClass": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "certmanager": {
          "type": "object",
          "description": "Cert-manager configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Whether to use cert-manager for certificate management"
            },
            "apiVersion": {
              "type": "string",
              "description": "API version of the cert-manager CRDs"
            }
          },
          "additionalProperties": false
        },
        "nodeSelector": {
          "type": "object",
          "description": "Node labels for pod assignment"
        },
        "tolerateAllTaints": {
          "type": "boolean",
          "description": "Whether to tolerate all taints"
        },
        "tolerations": {
          "type": "array",
          "description": "Tolerations for pod assignment",
          "items": {
            "type": "object"
          }
        },
        "affinity": {
          "type": "object",
          "description": "Affinity for pod assignment"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
