{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Gateway API Helm Chart Values Schema",
  "description": "Schema for validating values.yaml configuration for the Gateway API Helm chart",
  "properties": {
    "envoy": {
      "type": "object",
      "title": "Envoy Gateway Configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "title": "Enable Envoy Gateway",
          "description": "Enable or disable Envoy Gateway deployment",
          "default": true
        },
        "classes": {
          "type": "array",
          "title": "Gateway Classes",
          "description": "List of gateway classes to create",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "title": "Gateway Class Name"
              },
              "description": {
                "type": "string",
                "title": "Gateway Class Description"
              },
              "controllerName": {
                "type": "string",
                "title": "Controller Name"
              },
              "labels": {
                "type": "object",
                "title": "Labels",
                "additionalProperties": {
                  "type": "string"
                }
              },
              "annotations": {
                "type": "object",
                "title": "Annotations",
                "additionalProperties": {
                  "type": "string"
                }
              },
              "parametersRef": {
                "type": "object",
                "title": "Parameters Reference",
                "properties": {
                  "group": {
                    "type": "string"
                  },
                  "kind": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  }
                }
              }
            },
            "required": ["name"]
          },
          "default": []
        },
        "deployment": {
          "type": "object",
          "title": "Deployment Configuration",
          "properties": {
            "envoyGateway": {
              "type": "object",
              "properties": {
                "image": {
                  "type": "object",
                  "properties": {
                    "repository": {
                      "type": "string",
                      "title": "Image Repository"
                    },
                    "tag": {
                      "type": "string",
                      "title": "Image Tag"
                    }
                  }
                },
                "imagePullPolicy": {
                  "type": "string",
                  "enum": ["Always", "IfNotPresent", "Never", ""],
                  "title": "Image Pull Policy"
                },
                "imagePullSecrets": {
                  "type": "array",
                  "title": "Image Pull Secrets",
                  "items": {
                    "type": "object"
                  }
                },
                "resources": {
                  "type": "object",
                  "title": "Resource Limits and Requests",
                  "properties": {
                    "limits": {
                      "type": "object",
                      "properties": {
                        "memory": {
                          "type": "string",
                          "pattern": "^[0-9]+(Mi|Gi|Ki)$"
                        },
                        "cpu": {
                          "type": "string"
                        }
                      }
                    },
                    "requests": {
                      "type": "object",
                      "properties": {
                        "memory": {
                          "type": "string",
                          "pattern": "^[0-9]+(Mi|Gi|Ki)$"
                        },
                        "cpu": {
                          "type": "string"
                        }
                      }
                    }
                  }
                },
                "securityContext": {
                  "$ref": "#/definitions/securityContext"
                }
              }
            },
            "ports": {
              "type": "array",
              "title": "Service Ports",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "port": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 65535
                  },
                  "targetPort": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 65535
                  }
                },
                "required": ["name", "port", "targetPort"]
              }
            },
            "priorityClassName": {
              "type": ["string", "null"],
              "title": "Priority Class Name"
            },
            "replicas": {
              "type": "integer",
              "minimum": 1,
              "title": "Number of Replicas",
              "default": 1
            },
            "pod": {
              "type": "object",
              "title": "Pod Configuration",
              "properties": {
                "affinity": {
                  "type": "object",
                  "title": "Pod Affinity Rules"
                },
                "annotations": {
                  "type": "object",
                  "title": "Pod Annotations",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "labels": {
                  "type": "object",
                  "title": "Pod Labels",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "topologySpreadConstraints": {
                  "type": "array",
                  "title": "Topology Spread Constraints"
                },
                "tolerations": {
                  "type": "array",
                  "title": "Pod Tolerations"
                },
                "nodeSelector": {
                  "type": "object",
                  "title": "Node Selector",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "service": {
          "type": "object",
          "title": "Service Configuration",
          "properties": {
            "trafficDistribution": {
              "type": "string",
              "title": "Traffic Distribution Policy"
            },
            "annotations": {
              "type": "object",
              "title": "Service Annotations",
              "additionalProperties": {
                "type": "string"
              }
            }
          }
        },
        "hpa": {
          "type": "object",
          "title": "Horizontal Pod Autoscaler",
          "properties": {
            "enabled": {
              "type": "boolean",
              "title": "Enable HPA",
              "default": false
            },
            "minReplicas": {
              "type": "integer",
              "minimum": 1,
              "title": "Minimum Replicas",
              "default": 1
            },
            "maxReplicas": {
              "type": "integer",
              "minimum": 1,
              "title": "Maximum Replicas",
              "default": 1
            },
            "metrics": {
              "type": "array",
              "title": "HPA Metrics"
            },
            "behavior": {
              "type": "object",
              "title": "HPA Behavior"
            }
          }
        },
        "config": {
          "type": "object",
          "title": "Envoy Gateway Configuration",
          "properties": {
            "envoyGateway": {
              "type": "object",
              "properties": {
                "gateway": {
                  "type": "object",
                  "properties": {
                    "controllerName": {
                      "type": "string",
                      "title": "Gateway Controller Name"
                    }
                  }
                },
                "provider": {
                  "type": "object",
                  "properties": {
                    "type": {
                      "type": "string",
                      "enum": ["Kubernetes"],
                      "title": "Provider Type"
                    }
                  }
                },
                "logging": {
                  "type": "object",
                  "properties": {
                    "level": {
                      "type": "object",
                      "properties": {
                        "default": {
                          "type": "string",
                          "enum": ["debug", "info", "warn", "error"],
                          "title": "Default Log Level"
                        }
                      }
                    }
                  }
                },
                "extensionApis": {
                  "type": "object",
                  "title": "Extension APIs"
                }
              }
            }
          }
        },
        "createNamespace": {
          "type": "boolean",
          "title": "Create Namespace",
          "default": false
        },
        "kubernetesClusterDomain": {
          "type": "string",
          "title": "Kubernetes Cluster Domain",
          "default": "cluster.local"
        },
        "certgen": {
          "type": "object",
          "title": "Certificate Generation Configuration",
          "properties": {
            "job": {
              "type": "object",
              "properties": {
                "annotations": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "args": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "resources": {
                  "type": "object"
                },
                "affinity": {
                  "type": "object"
                },
                "tolerations": {
                  "type": "array"
                },
                "nodeSelector": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "ttlSecondsAfterFinished": {
                  "type": "integer",
                  "minimum": 0
                },
                "securityContext": {
                  "$ref": "#/definitions/securityContext"
                }
              }
            },
            "rbac": {
              "type": "object",
              "properties": {
                "annotations": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "labels": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "topologyInjector": {
          "type": "object",
          "title": "Topology Injector Configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "annotations": {
              "type": "object",
              "additionalProperties": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "nginx": {
      "type": "object",
      "title": "NGINX Gateway Fabric Configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "title": "Enable NGINX Gateway",
          "default": false
        },
        "gatewayClassName": {
          "type": "string",
          "title": "Gateway Class Name",
          "default": "nginx"
        },
        "gatewayClassAnnotations": {
          "type": "object",
          "title": "Gateway Class Annotations",
          "additionalProperties": {
            "type": "string"
          }
        }
      }
    },
    "traefik": {
      "type": "object",
      "title": "Traefik Gateway Configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "title": "Enable Traefik Gateway",
          "default": false
        },
        "ingressClass": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            }
          }
        },
        "gateway": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            }
          }
        },
        "gatewayClass": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "name": {
              "type": "string"
            },
            "labels": {
              "type": "object",
              "additionalProperties": {
                "type": "string"
              }
            }
          }
        },
        "kubernetesIngress": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            }
          }
        },
        "kubernetesGateway": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            }
          }
        },
        "knative": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            }
          }
        }
      }
    }
  },
  "definitions": {
    "securityContext": {
      "type": "object",
      "title": "Security Context",
      "properties": {
        "allowPrivilegeEscalation": {
          "type": "boolean"
        },
        "capabilities": {
          "type": "object",
          "properties": {
            "drop": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "add": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "privileged": {
          "type": "boolean"
        },
        "runAsNonRoot": {
          "type": "boolean"
        },
        "runAsGroup": {
          "type": "integer",
          "minimum": 0
        },
        "runAsUser": {
          "type": "integer",
          "minimum": 0
        },
        "readOnlyRootFilesystem": {
          "type": "boolean"
        },
        "seccompProfile": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["RuntimeDefault", "Unconfined"]
            }
          }
        }
      }
    }
  }
}
