# Certificate Authority (CA) Chart

Thank you for installing the CA Helm chart!

This chart manages Certificate Authority resources including Issuers, ClusterIssuers, and Certificates for secure certificate management in your Kubernetes cluster.

## Installation Summary

{{- if .Values.certmanager.enabled }}
- **cert-manager**: Installed as dependency
{{- else }}
- **cert-manager**: Using pre-existing installation
{{- end }}
{{- if .Values.trustmanager.enabled }}
- **trust-manager**: Installed as dependency
{{- end }}
{{- if .Values.issuers }}
- **Issuers**: {{ len .Values.issuers }} configured
{{- end }}
{{- if .Values.certificates }}
- **Certificates**: {{ len .Values.certificates }} configured
{{- end }}

## Verification Steps

1. **Check Resource Creation Jobs**:
   ```bash
   kubectl get jobs -n {{ .Release.Namespace }} -l helm.sh/hook=post-install
   ```

2. **Verify Issuers**:
   ```bash
   kubectl get issuers,clusterissuers -A
   kubectl describe issuers,clusterissuers -A
   ```

3. **Check Certificates**:
   ```bash
   kubectl get certificates -n {{ .Release.Namespace }}
   kubectl describe certificates -n {{ .Release.Namespace }}
   ```

4. **Monitor Certificate Status**:
   ```bash
   kubectl get certificaterequests -n {{ .Release.Namespace }}
   kubectl get secrets -n {{ .Release.Namespace }} | grep tls
   ```

## Troubleshooting

**If resource creation fails:**
1. Check Job logs:
   ```bash
   kubectl logs -n {{ .Release.Namespace }} jobs/create-issuer-* --follow
   kubectl logs -n {{ .Release.Namespace }} jobs/create-certificate-* --follow
   ```

2. Verify cert-manager is running:
   ```bash
   kubectl get pods -n cert-manager
   kubectl get crd | grep cert-manager
   ```

3. Check events:
   ```bash
   kubectl get events -n {{ .Release.Namespace }} --sort-by='.lastTimestamp'
   ```

## Configuration

**Chart Dependencies:**
{{- if .Values.certmanager.enabled }}
- cert-manager v{{ (index .Chart.Dependencies 0).version }}
{{- end }}
{{- if .Values.trustmanager.enabled }}
- trust-manager v{{ (index .Chart.Dependencies 1).version }}
{{- end }}

**Resource Types Supported:**
- Self-signed Issuers (`selfSigned: true`)
- CA Issuers (`type: ca`)
- Vault Issuers (`type: vault`)
- ACME Issuers (`type: acme`)
- X.509 Certificates with DNS names and IP addresses

## Cleanup

To remove all resources:
```bash
helm uninstall {{ .Release.Name }} -n {{ .Release.Namespace }}
```

**Note**: Jobs with post-install hooks will be cleaned up automatically by Helm.
