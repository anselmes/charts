{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "CNI Chart Values Schema",
  "description": "Schema for the CNI (Container Network Interface) Helm chart values",
  "properties": {
    "cilium": {
      "type": "object",
      "description": "Configuration for the Cilium CNI plugin",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable or disable the Cilium CNI plugin deployment",
          "default": true
        },
        "bgp": {
          "type": "object",
          "description": "Configuration for BGP (Border Gateway Protocol)",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable or disable BGP functionality",
              "default": false
            },
            "nodeSelector": {
              "type": "object",
              "description": "Node selector for BGP instances",
              "properties": {
                "matchLabels": {
                  "type": "object",
                  "description": "Match labels for node selection",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              },
              "additionalProperties": false
            },
            "advert": {
              "type": "object",
              "description": "Advertisement configuration for BGP",
              "properties": {
                "service": {
                  "type": "object",
                  "description": "Service advertisement configuration",
                  "properties": {
                    "selector": {
                      "type": "object",
                      "description": "Selector for services to advertise",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "description": "Match expressions for service selection",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string",
                                "description": "Label key"
                              },
                              "operator": {
                                "type": "string",
                                "description": "Match operator",
                                "enum": ["In", "NotIn", "Exists", "DoesNotExist"]
                              },
                              "values": {
                                "type": "array",
                                "description": "Label values",
                                "items": {
                                  "type": "string"
                                }
                              }
                            },
                            "required": ["key", "operator"],
                            "additionalProperties": false
                          }
                        }
                      },
                      "additionalProperties": false
                    },
                    "addresses": {
                      "type": "array",
                      "description": "Address types to advertise via BGP",
                      "items": {
                        "type": "string",
                        "enum": ["ExternalIP", "LoadBalancerIP", "ClusterIP"]
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "podCIDR": {
                  "type": "object",
                  "description": "Pod CIDR advertisement configuration",
                  "properties": {
                    "attributes": {
                      "type": "object",
                      "description": "BGP attributes for pod CIDR",
                      "properties": {
                        "localPreference": {
                          "type": "integer",
                          "description": "BGP local preference value",
                          "minimum": 0,
                          "maximum": 4294967295
                        },
                        "communities": {
                          "type": "object",
                          "description": "BGP communities",
                          "properties": {
                            "standard": {
                              "type": "array",
                              "description": "Standard BGP communities",
                              "items": {
                                "type": "string",
                                "pattern": "^[0-9]+:[0-9]+$"
                              }
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            },
            "peer": {
              "type": "object",
              "description": "BGP peer configuration",
              "properties": {
                "authSecretRef": {
                  "type": "string",
                  "description": "Reference to Kubernetes secret for BGP authentication"
                },
                "gracefulRestart": {
                  "type": "boolean",
                  "description": "Enable graceful restart for BGP sessions",
                  "default": true
                },
                "holdTimeSec": {
                  "type": "integer",
                  "description": "Hold time in seconds for BGP sessions",
                  "minimum": 3,
                  "maximum": 65535
                },
                "keepAliveTimeSec": {
                  "type": "integer",
                  "description": "Keep-alive time in seconds for BGP sessions",
                  "minimum": 1,
                  "maximum": 21845
                },
                "multiHop": {
                  "type": "integer",
                  "description": "Number of hops allowed for multi-hop BGP sessions",
                  "minimum": 1,
                  "maximum": 255
                },
                "restartTimeSec": {
                  "type": "integer",
                  "description": "Restart time in seconds for BGP sessions",
                  "minimum": 1,
                  "maximum": 4095
                },
                "addressFamilies": {
                  "type": "array",
                  "description": "Address families supported by BGP",
                  "items": {
                    "type": "object",
                    "properties": {
                      "afi": {
                        "type": "string",
                        "description": "Address Family Identifier",
                        "enum": ["ipv4", "ipv6", "l2vpn"]
                      },
                      "safi": {
                        "type": "string",
                        "description": "Subsequent Address Family Identifier",
                        "enum": ["unicast", "multicast", "flowspec", "evpn"]
                      },
                      "advertisements": {
                        "type": "object",
                        "description": "Advertisement configuration for this address family",
                        "properties": {
                          "matchLabels": {
                            "type": "object",
                            "description": "Labels to match for advertisements",
                            "additionalProperties": {
                              "type": "string"
                            }
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "required": ["afi", "safi"],
                    "additionalProperties": false
                  }
                }
              },
              "additionalProperties": false
            },
            "instances": {
              "type": "array",
              "description": "BGP instance configurations",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Name of the BGP instance"
                  },
                  "localASN": {
                    "type": "integer",
                    "description": "Local Autonomous System Number",
                    "minimum": 1,
                    "maximum": 4294967295
                  },
                  "overrides": {
                    "type": "object",
                    "description": "Override configuration for the instance",
                    "properties": {
                      "enabled": {
                        "type": "boolean",
                        "description": "Enable or disable overrides"
                      },
                      "routerID": {
                        "type": "string",
                        "description": "Router ID for the instance",
                        "anyOf": [
                          {
                            "format": "ipv4"
                          },
                          {
                            "format": "ipv6"
                          }
                        ]
                      }
                    },
                    "additionalProperties": false
                  },
                  "peers": {
                    "type": "array",
                    "description": "BGP peers for this instance",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "Name of the BGP peer"
                        },
                        "peerASN": {
                          "type": "integer",
                          "description": "Autonomous System Number of the peer",
                          "minimum": 1,
                          "maximum": 4294967295
                        },
                        "localAddress": {
                          "type": "string",
                          "description": "Local address for the peer connection",
                          "anyOf": [
                            {
                              "format": "ipv4"
                            },
                            {
                              "format": "ipv6"
                            }
                          ]
                        },
                        "peerAddress": {
                          "type": "string",
                          "description": "Address of the BGP peer",
                          "anyOf": [
                            {
                              "format": "ipv4"
                            },
                            {
                              "format": "ipv6"
                            }
                          ]
                        },
                        "peerConfigRef": {
                          "type": "object",
                          "description": "Reference to peer configuration",
                          "properties": {
                            "name": {
                              "type": "string",
                              "description": "Name of the peer configuration resource"
                            }
                          },
                          "required": ["name"],
                          "additionalProperties": false
                        }
                      },
                      "required": ["name", "peerASN", "peerAddress"],
                      "additionalProperties": false
                    }
                  }
                },
                "required": ["name", "localASN"],
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        },
        "l2": {
          "type": "object",
          "description": "Configuration for Layer 2 networking",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable or disable L2 functionality",
              "default": false
            },
            "externalIPs": {
              "type": "boolean",
              "description": "Advertise external IPs via L2",
              "default": true
            },
            "loadBalancerIPs": {
              "type": "boolean",
              "description": "Advertise load balancer IPs via L2",
              "default": true
            }
          },
          "additionalProperties": false
        },
        "pool": {
          "type": "object",
          "description": "Configuration for IP address pools",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable or disable IP address pooling",
              "default": true
            },
            "allowFirstLastIPs": {
              "type": "string",
              "description": "Allow or disallow the use of first and last IPs in the pool",
              "enum": ["Yes", "No"],
              "default": "No"
            },
            "cidr": {
              "type": "string",
              "description": "CIDR block for the IP address pool",
              "pattern": "^([0-9]{1,3}\\.){3}[0-9]{1,3}/[0-9]{1,2}$"
            }
          },
          "additionalProperties": false
        },
        "kubeProxyReplacement": {
          "type": "boolean",
          "description": "Enable or disable kube-proxy replacement by Cilium",
          "default": true
        },
        "bgpControlPlane": {
          "type": "object",
          "description": "BGP control plane configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable or disable the BGP control plane",
              "default": true
            }
          },
          "additionalProperties": true
        },
        "gatewayAPI": {
          "type": "object",
          "description": "Gateway API configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable or disable Gateway API support",
              "default": false
            }
          },
          "additionalProperties": true
        },
        "envoy": {
          "type": "object",
          "description": "Envoy proxy configuration",
          "properties": {
            "securityContext": {
              "type": "object",
              "description": "Security context for Envoy",
              "properties": {
                "capabilities": {
                  "type": "object",
                  "description": "Capabilities configuration",
                  "properties": {
                    "keepCapNetBindService": {
                      "type": "boolean",
                      "description": "Retain NET_BIND_SERVICE capability for Envoy"
                    },
                    "envoy": {
                      "type": "array",
                      "description": "Capabilities to add for Envoy",
                      "items": {
                        "type": "string",
                        "enum": [
                          "AUDIT_CONTROL", "AUDIT_READ", "AUDIT_WRITE",
                          "BLOCK_SUSPEND", "CHOWN", "DAC_OVERRIDE",
                          "DAC_READ_SEARCH", "FOWNER", "FSETID",
                          "IPC_LOCK", "IPC_OWNER", "KILL", "LEASE",
                          "LINUX_IMMUTABLE", "MAC_ADMIN", "MAC_OVERRIDE",
                          "MKNOD", "NET_ADMIN", "NET_BIND_SERVICE",
                          "NET_BROADCAST", "NET_RAW", "SETFCAP",
                          "SETGID", "SETPCAP", "SETUID", "SYS_ADMIN",
                          "SYS_BOOT", "SYS_CHROOT", "SYS_MODULE",
                          "SYS_NICE", "SYS_PACCT", "SYS_PTRACE",
                          "SYS_RAWIO", "SYS_RESOURCE", "SYS_TIME",
                          "SYS_TTY_CONFIG", "SYSLOG", "WAKE_ALARM"
                        ]
                      }
                    }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": true
            }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    },
    "global": {
      "type": "object",
      "description": "Global configuration that applies to all components",
      "properties": {
        "imageRegistry": {
          "type": "string",
          "description": "Global Docker image registry"
        },
        "imagePullSecrets": {
          "type": "array",
          "description": "Global image pull secrets",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the image pull secret"
              }
            },
            "required": ["name"],
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
